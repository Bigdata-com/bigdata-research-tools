from typing import Dict

from bigdata_research_tools.screeners.patents_buzz import PatentsBuzzFactor
from bigdata_research_tools.search.screener_search import look_up_entities_binary_search

SP_500_ENTITIES = [
    "FF6644",
    "A43906",
    "86A1B9",
    "616E3B",
    "6B236C",
    "CBA33B",
    "164D72",
    "78F9ED",
    "6E7060",
    "968B00",
    "3C7F5F",
    "D9B1C9",
    "ADF092",
    "D8F347",
    "106394",
    "AFD7DD",
    "B5DE80",
    "D1AE3B",
    "EB6965",
    "9B5968",
    "15ABD0",
    "B642E8",
    "4595EF",
    "3CCC90",
    "85DE00",
    "60F8A4",
    "7B0BA6",
    "508CFD",
    "9C25FF",
    "6EB9DA",
    "G47HNQ",
    "408089",
    "56277A",
    "6E705B",
    "7D5FD6",
    "DD1BA1",
    "F5C8AB",
    "D33D8C",
    "119CB6",
    "BB07E4",
    "C03C8B",
    "2B49F4",
    "8E82A6",
    "7999F3",
    "DB5CA5",
    "A1EAC8",
    "0BF4BA",
    "C29715",
    "AFEC35",
    "72DF04",
    "7A10FF",
    "A6213D",
    "285175",
    "D6534D",
    "C356AC",
    "E26FC3",
    "F5D410",
    "641F17",
    "89F693",
    "CE1002",
    "E8B21D",
    "64E346",
    "388E00",
    "8C5519",
    "275300",
    "5E6959",
    "808319",
    "09E31A",
    "EAEBF3",
    "972356",
    "C97B2D",
    "228D42",
    "1791E7",
    "EB5E78",
    "8E8E6E",
    "E0339F",
    "E866D2",
    "FACF19",
    "34A959",
    "9CA619",
    "F30508",
    "4030E2",
    "57B174",
    "D90F43",
    "69E8E1",
    "9X9IT8",
    "56EA2B",
    "767F86",
    "1F9D90",
    "C9E107",
    "2BA977",
    "7448A3",
    "59B229",
    "56CC0A",
    "E70531",
    "EC99D0",
    "507AE7",
    "DCD97F",
    "AD23DE",
    "C598D7",
    "12E454",
    "F1C69A",
    "14ED2B",
    "A18D3C",
    "E15736",
    "9D2790",
    "B8EF97",
    "7AB859",
    "0B57D7",
    "C5EF8D",
    "E6E012",
    "7C62A3",
    "1490F3",
    "790C34",
    "ECD263",
    "E8846E",
    "353DBB",
    "A247F5",
    "4A6F00",
    "322A44",
    "76F067",
    "32BBAA",
    "CA1620",
    "63F892",
    "37727A",
    "D8442A",
    "A4386C",
    "385DD4",
    "C44D01",
    "D54E62",
    "FF4BA4",
    "6BF593",
    "57CAAB",
    "FEC475",
    "619882",
    "DE27F9",
    "F1529C",
    "17EDA5",
    "A7102F",
    "0A0D9E",
    "E68C3D",
    "351EC3",
    "93D207",
    "C8A248",
    "CE4FD9",
    "902670",
    "6ED519",
    "304C94",
    "CA212F",
    "1E169E",
    "20BEEA",
    "B8F71F",
    "7BFF81",
    "BB127B",
    "CE96E7",
    "D2AC74",
    "DB7014",
    "66E04A",
    "E1C16B",
    "168A5D",
    "B4C673",
    "45CF4C",
    "B840EF",
    "5A6336",
    "C951A2",
    "I8DQKN",
    "221AD7",
    "873DB9",
    "8C6C1B",
    "9F6B1A",
    "070B45",
    "76E80F",
    "061366",
    "1F716B",
    "D29B44",
    "69CE71",
    "BFAEB4",
    "BFE02C",
    "5DE5A5",
    "AD1ACF",
    "B2E6B5",
    "520632",
    "E124EB",
    "9F03CF",
    "945DE6",
    "442769",
    "2D643C",
    "143C52",
    "61BCA7",
    "D0909F",
    "6E1E61",
    "B13B68",
    "ECF709",
    "C659EB",
    "5E7E82",
    "3F4497",
    "94208D",
    "9196A2",
    "D56D6D",
    "A5B913",
    "BA2D83",
    "D64C6D",
    "24CB56",
    "91B8B1",
    "9C5BA5",
    "C20B75",
    "D6489C",
    "97AAF6",
    "55C9B5",
    "FD6926",
    "66ECFD",
    "719477",
    "4AC91D",
    "2E0496",
    "1921DD",
    "7D85A9",
    "B3CB74",
    "88923D",
    "50070E",
    "D88EF3",
    "87B81A",
    "64CEBB",
    "C08256",
    "BB88B6",
    "C15DB3",
    "2DBF98",
    "58CA9A",
    "14BA06",
    "FC1F9D",
    "EFD406",
    "5F9CE3",
    "E206B0",
    "2BAE5F",
    "6ABCB8",
    "C062D4",
    "2E61CC",
    "C8257F",
    "AE4EEB",
    "766047",
    "8E0E32",
    "AA5C8E",
    "3D9999",
    "D21EF3",
    "BF79F5",
    "2F98A5",
    "96F126",
    "FAE021",
    "9BBFA5",
    "HTA3J9",
    "2FEA66",
    "F1FA25",
    "14C7B2",
    "D4AC65",
    "LIVBLM",
    "F46EC9",
    "12A3A3",
    "CF7292",
    "267718",
    "E94704",
    "789A7D",
    "C9B932",
    "9A02C4",
    "622DBE",
    "E09E2B",
    "2158DF",
    "61E975",
    "9D30A8",
    "9AF3DC",
    "2D2D43",
    "3FB145",
    "FC1B7B",
    "9A3FF4",
    "F57F6F",
    "39FB23",
    "665D7D",
    "652E62",
    "7E3F8F",
    "A4BCDE",
    "00067A",
    "013528",
    "E21871",
    "C87ECC",
    "6B0784",
    "E10D31",
    "B2256A",
    "5A9A82",
    "977A1E",
    "810E30",
    "990AD0",
    "147C38",
    "188394",
    "ACF77B",
    "6DBBBC",
    "2667B6",
    "41B0E2",
    "E68733",
    "D4463B",
    "BB5271",
    "LJPA1L",
    "2CB4C9",
    "07EC43",
    "AA7FE0",
    "3587B4",
    "DB06B0",
    "FE89E0",
    "92D3A0",
    "3DC887",
    "420168",
    "EC821B",
    "1A3E1B",
    "342218",
    "A01664",
    "F67165",
    "6844D2",
    "BB0787",
    "FA40E2",
    "8665BA",
    "DF8855",
    "8B4A45",
    "8377DB",
    "D437C3",
    "E90C84",
    "33AD83",
    "A63820",
    "C9881C",
    "159AE4",
    "91C82E",
    "B560AF",
    "F93C8A",
    "7B1E50",
    "F11638",
    "940C3D",
    "8EA478",
    "EF5BED",
    "9F18FA",
    "3CBA2A",
    "AA98ED",
    "CC6FF5",
    "E30B34",
    "EEEA9F",
    "1151F4",
    "9E91C6",
    "371C01",
    "5DD486",
    "1D1B07",
    "D60BB2",
    "ED0402",
    "CDFCC9",
    "09F623",
    "32CB22",
    "3461CF",
    "8D4486",
    "DA48E4",
    "39BFF6",
    "003B70",
    "A5151E",
    "6CC55E",
    "F40EE2",
    "063384",
    "5F2FF7",
    "366A08",
    "315EB0",
    "E4CE73",
    "35F4B5",
    "61B81B",
    "954E30",
    "DD682D",
    "AADE0B",
    "5BC2F4",
    "60DD84",
    "DBB28E",
    "1FAF22",
    "51D876",
    "3DE4D1",
    "9D56F2",
    "8AM205",
    "03CF95",
    "253B2F",
    "4FB770",
    "99333F",
    "2B7A40",
    "58B46F",
    "6B5379",
    "416C55",
    "D69D42",
    "5CC29D",
    "D4070C",
    "789ADD",
    "A6828A",
    "504FE2",
    "34B97A",
    "26CC63",
    "B7EB38",
    "6166D1",
    "F6DCE4",
    "A52B6B",
    "9C8BC3",
    "1EBF8D",
    "7AC86E",
    "69345C",
    "C4A432",
    "DC5299",
    "067779",
    "3ED92D",
    "7E1D5D",
    "751A74",
    "6F6559",
    "543900",
    "636639",
    "40B903",
    "EEA6B3",
    "D09938",
    "57DDB9",
    "EE6F1C",
    "1D9E55",
    "25102A",
    "AD3C93",
    "12DE76",
    "51E682",
    "18EC17",
    "55438C",
    "5ABEC0",
    "D64EDF",
    "C4073B",
    "CFF97C",
    "9C5174",
    "2F94A5",
    "0BC29E",
    "FEE4B0",
    "C83B88",
    "034B61",
    "03B8CF",
    "9F71E5",
    "6284B5",
    "B6082A",
    "3FACA7",
    "8A8E41",
    "E49AA3",
    "713810",
    "95DC1F",
    "B303A6",
    "190B91",
    "431B74",
    "5B6C11",
    "131443",
    "6137BF",
    "4C37C5",
    "251988",
    "94637C",
    "370C50",
    "900356",
    "A80FE0",
    "205AD5",
    "0157B1",
    "934CC3",
    "F6E248",
    "8EF425",
    "C81E00",
    "7BAAE7",
    "FD39EB",
    "DD3BB1",
    "ACDF88",
    "9A602D",
    "D96202",
    "CEDFD5",
    "A8CBDA",
    "06EF42",
    "49BBBC",
    "8FF2EF",
    "485445",
    "39692D",
    "DC2B00",
    "D5AF19",
    "73C521",
    "ED79D9",
    "859D62",
    "986AF6",
    "09DE1F",
    "24C48B",
    "B4703C",
    "055018",
    "1BC12C",
    "589803",
    "662682",
    "24D81E",
    "44A4FC",
    "7F9984",
    "QRHIPR",
    "THC8Q8",
    "567F3D",
    "30A565",
    "93F143",
    "4A5C8D",
    "CFF15D",
    "434F38",
    "36ECA4",
    "911AB8",
    "CD2DA4",
    "97693A",
    "343996",
]


def patents_buzz_example() -> Dict:

    companies = look_up_entities_binary_search(SP_500_ENTITIES)

    patents_buzz_factor = PatentsBuzzFactor(
        llm_model="openai::gpt-4o-mini",
        embeddings_model="openai::text-embedding-3-small",
        main_theme="AI Solutions",
        companies=companies,
        start_date="2024-06-01",
        end_date="2024-12-31",
    ).screen_companies(frequency="M", export_path="patents_buzz.xlsx")
    return patents_buzz_factor


if __name__ == "__main__":

    from dotenv import load_dotenv

    # Load environment variables for authentication
    print(f"Environment variables loaded: {load_dotenv()}")

    patents_buzz_example()
